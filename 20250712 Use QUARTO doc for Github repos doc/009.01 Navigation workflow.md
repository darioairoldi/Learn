# Navigation.json Generation Workflow

## Overview
The `navigation.json` file is automatically generated from `_quarto.yml` to power the Related Pages functionality in the right sidebar.

## How It Works

### Automatic Generation
- **When**: Only when `navigation.json` is missing or older than `_quarto.yml`
- **Where**: Generated by `scripts/generate-navigation.ps1`
- **Trigger**: Pre-render hook in `_quarto.yml`

### Versioning
- ? **navigation.json IS versioned** in the repository
- ? **No need to regenerate** if file is current
- ? **Automatic updates** when `_quarto.yml` changes

## Local Development

### Option 1: Use Development Script
```bash
./dev-serve.bat
```

### Option 2: Manual Commands
```powershell
# Generate navigation.json (if needed)
powershell scripts/generate-navigation.ps1

# Start Quarto preview
quarto preview
```

### Option 3: Standard Quarto (with pre-render hook)
```bash
quarto render
# or
quarto preview
```

## How It Detects Changes

The script compares file timestamps:
- If `_quarto.yml` is newer ? Regenerates `navigation.json`
- If `navigation.json` is current ? Skips generation
- If `navigation.json` is missing ? Generates it

## Dependencies

### Required
- PowerShell (Windows)
- `_quarto.yml` file

### Auto-Downloaded
- `yq` (YAML processor) - downloaded automatically if not found

## Files

| File | Purpose | Versioned |
|------|---------|-----------|
| `navigation.json` | Navigation data for website | ? Yes |
| `scripts/generate-navigation.ps1` | Generation script | ? Yes |
| `yq.exe` | YAML processor tool | ? No (auto-downloaded) |

## Troubleshooting

### navigation.json not found error
- Run: `powershell scripts/generate-navigation.ps1`
- Ensure `_quarto.yml` exists

### Permission errors
- Run: `powershell -ExecutionPolicy Bypass -File scripts/generate-navigation.ps1`

### yq download fails
- Check internet connection
- Manual download from: https://github.com/mikefarah/yq/releases